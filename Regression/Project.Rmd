---
title: "Regression Models - Course Project"
output: pdf_document
fontsize: 10pt
---


```{r echo=FALSE,message=FALSE,warning=FALSE,error=FALSE}
require(GGally);require(car);
data(mtcars);
all<-lm(mpg~.,mtcars)
wthp<-lm(mpg~wt+hp,mtcars)
#wthpqsec<-lm(mpg~wt+hp+qsec,mtcars)
wthpam<-lm(mpg~wt+hp+am,mtcars)
wthpqsecam<-lm(mpg~wt+hp+qsec+am,mtcars)
wthpqsecamdspl<-lm(mpg~wt+hp+qsec+am+disp,mtcars)
models<-list("all"=all,"wthp"=wthp,"wthpam"=wthpam,"wthpqsecam"=wthpqsecam,"wthpqsecamdspl"=wthpqsecamdspl)

modeladjrsquare<-sapply(models,function(x){summary(x)$adj.r.squared})
names(modeladjrsquare)<-names(models)
```

## Executive Summary
Analysis to answer the following two questions based on a motor vehicle data set.  
1) "Is an automatic or manual transmission better for MPG"  
2) "How different is the MPG between automatic manual transmission?"  

Multiple regression models were evaluated and used to answer the above questions.

## Results
Detailed analysis with the dataset revealed that transmission type DOES NOT have
a statistically significant effect on gas mileage. 

The estimate of improved gas mileage of manual transmission over automatic is 2.08 mpg, 
when using a model with wt,hp and transmission as the predictors. However the effect of   
transmission cannot be considered significant since its p-value is 0.14 - not enough 
to reject the null hypothesis that transmission has no effect on mpg.

Weight and horsepower were found to be the two most significant factors in estimating mpg 
with p values close to zero.
## Description of analysis done
Initially a multivariable regression was done with all available data to serve as a baseline.
The adjusted Rsquare was found to be 0.8066 . This analysis is not ideal as it does not 
address multicollinearity, and includes several variables that ought not to affect mpg.  

###Model Selection
From studying several semesters of automobile engineering during B.Tech(Mechanical) I can classify the factors as YES/NO/MAYBE  [Expert Opinion]

NO: Axle ratios, Gear/Carburetor/Cylinder count, V/Straight engine layout, will not affect mpg.
YES: Weight and horsepower(hp) definitely affect mpg. To produce more power more gas is burnt.  
Energy expended to move a mass is directly proportional to its mass.  
MAYBE:  Quarter mile time  can be considered but would be expected to show collinearity with hp.  
Engine displacement(size) only has an indirect effect on power and not a very linear one. This is due to dependencies on other factors not included in the data. However it was evaluated.

###Exploratory Analysis
A pairs plot of the factors considered possibly relevant is shown in appendix.  
This shows a high negative correlation between mpg vs weight, displacement & hp.
Displacement is also highly correlated with weight[0.89] and hp[0.79] 

####Variance Inflation Factors
```{r echo=FALSE}
vif(all)
```

cyl, disp and weight showed the highest variance inflation factors in a model including  
all variables indicating possible collinearity. This also makes intuitive sense since  
larger displacement engines have more cylinders and are heavier.

Four additional models were constructed. The model names reflect their factors  
wthp | wthpam | wthpqsecam |wthpqsecamdspl|  

for instance wthp uses wt and hp, wthpam uses wt,hp and am and so on.  

First examine their adjusted R squared. The adjusted R square statistic, unlike R square, penalizes for using more variables.  

#### Adjusted R Square of different models
```{r adjrsqcomp, echo=FALSE}
modeladjrsquare
```

Examining the adjusted r square values showed a major improvement in using just wt&hp 
over using all available variables. 

The benefit of adding in am was minor [0.0078961] indicating that transmission may not  
be a big facator in predicting mpg.   
If using both qsecandam there was a tiny bit better adj.r.squared. 
Adding in displ did almost nothing to improve this, validating our earlier assumption 
that if horsepower is already factored in, displacement is not a significant predictor.

Weight and Horsepower seem to explain most of the variation in mpg. This was examined
using anova, which showed no significant benefit in adding in transmission type.

```{r anova, echo=FALSE}
anova(wthp,wthpam,wthpqsecam,wthpqsecamdspl)
```

The p value for adding am to mpg+wt is quite high -  0.12590. This is not good enough 
to reject the null hyphothesis - that the transmission does not have a significant effect on mpg.

As a last step we examine a model using wt, hp and am and examine its coefficients

```{r summarycoeffs, echo=FALSE}
summary(wthpam)$coefficients
```
The transmission type has a slope of 2.08 which would have been its effect on mpg if  
it was significant. However its p value is 0.14 which is much much higher than permissible.
We must conclude that the trasmission type has no significant effect on gas mileage.


## Appendix

```{r exploratory,echo=FALSE,warning=FALSE,error=F, fig.width=10,fig.height=15}
ggpairs(c(1,3,4,6,7,9),data=mtcars,lower=list(continous="smooth",params=c(method="loess")))
```



### Residuals of model with weight and horsepower only


```{r residualplot, echo=FALSE,warning=FALSE,error=F, fig.width=10}
par(mfrow=c(2,2))
plot(wthp)
```
